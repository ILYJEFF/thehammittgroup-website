# Database Setup Guide - Neon + Vercel

## Why You Need a Database

Yes, you **absolutely need a database** to use:
- ✅ **Blog posts** - Store and manage blog content
- ✅ **Admin portal** - Admin login and authentication
- ✅ **Contact submissions** - Store contact form submissions
- ✅ **Candidate submissions** - Store resume submissions

## Recommended: Neon (Perfect for Vercel)

Neon is a serverless PostgreSQL database that works seamlessly with Vercel. It's free to start and scales automatically.

## Step-by-Step Setup

### 1. Create Neon Database

1. Go to [neon.tech](https://neon.tech) and sign up (free tier available)
2. Click **"Create Project"**
3. Fill in:
   - **Project name**: `thehammittgroup-website`
   - **Region**: Choose closest to your users (e.g., `US East` for Texas)
   - **PostgreSQL version**: Latest (15 or 16)
4. Click **"Create Project"**
5. Wait ~30 seconds for database to be created

### 2. Get Connection String

1. In your Neon dashboard, you'll see your project
2. Click on **"Connection Details"** or look for the connection string
3. You'll see something like:
   ```
   postgresql://username:password@ep-xxxxx.us-east-2.aws.neon.tech/neondb?sslmode=require
   ```
4. **Copy this connection string** - you'll need it in the next steps

### 3. Set Up Local Development

1. Create a `.env` file in your project root (if it doesn't exist):
   ```bash
   touch .env
   ```

2. Add your connection string to `.env`:
   ```env
   DATABASE_URL="postgresql://username:password@ep-xxxxx.us-east-2.aws.neon.tech/neondb?sslmode=require"
   NEXTAUTH_URL="http://localhost:3000"
   NEXTAUTH_SECRET="aaUow/5qen9yGKrwRG3fQeIfyLEG33VgZtwsYROLELg="
   NEXT_PUBLIC_BASE_URL="http://localhost:3000"
   ```

3. **Important**: Replace the connection string with your actual Neon connection string

### 4. Initialize Database Schema

Run these commands in your terminal:

```bash
# Generate Prisma Client
npx prisma generate

# Push schema to database (creates all tables)
npx prisma db push

# Create your admin user
npm run create-admin
```

When running `create-admin`, enter:
- **Email**: Your admin email (e.g., `jeff@thehammittgroup.com`)
- **Password**: A strong password

### 5. Set Up Vercel Environment Variables

1. Go to your Vercel project dashboard
2. Navigate to **Settings** → **Environment Variables**
3. Add these variables:

   **For Production:**
   ```
   DATABASE_URL = your-neon-connection-string
   NEXTAUTH_URL = https://your-domain.vercel.app
   NEXTAUTH_SECRET = aaUow/5qen9yGKrwRG3fQeIfyLEG33VgZtwsYROLELg=
   NEXT_PUBLIC_BASE_URL = https://your-domain.vercel.app
   ```

   **For Preview/Development (optional):**
   ```
   DATABASE_URL = your-neon-connection-string
   NEXTAUTH_URL = https://your-preview-url.vercel.app
   NEXTAUTH_SECRET = aaUow/5qen9yGKrwRG3fQeIfyLEG33VgZtwsYROLELg=
   NEXT_PUBLIC_BASE_URL = https://your-preview-url.vercel.app
   ```

### 6. Run Migrations on Production

After deploying to Vercel, you need to run the database migrations. You have two options:

**Option A: Using Vercel CLI (Recommended)**
```bash
# Install Vercel CLI if you haven't
npm i -g vercel

# Login to Vercel
vercel login

# Link your project
vercel link

# Run migrations
vercel env pull .env.production
npx prisma db push
```

**Option B: Using Neon SQL Editor**
1. Go to Neon dashboard → SQL Editor
2. Run the SQL generated by Prisma (or use `prisma migrate dev` to generate migration SQL)

**Option C: One-time Script (Easiest)**
Create a script that runs on first deployment. I can help you set this up.

### 7. Verify Everything Works

1. **Test locally:**
   ```bash
   npm run dev
   ```
   - Visit `http://localhost:3000/admin/login`
   - Login with your admin credentials
   - Try creating a blog post
   - Submit a test contact form

2. **Test on Vercel:**
   - After deployment, visit `https://your-domain.vercel.app/admin/login`
   - Login and verify admin portal works
   - Test contact form submission

## What You Get After Setup

✅ **Blog Management**
- Create, edit, and publish blog posts
- Manage categories and tags
- SEO optimization for each post

✅ **Admin Portal**
- View all contact form submissions
- View all candidate resume submissions
- Filter and export submissions
- Manage blog content

✅ **Contact Forms**
- All submissions stored in database
- Viewable in admin dashboard
- Exportable for follow-up

✅ **Candidate Submissions**
- Resume uploads stored securely
- Status tracking (new, reviewing, contacted, placed)
- Filter by location, industry, position

## Neon Free Tier Limits

- **Storage**: 3 GB
- **Compute**: 0.5 vCPU
- **Branches**: 1 project branch
- **Perfect for**: Small to medium websites

This is more than enough for your recruitment website!

## Alternative: Supabase

If you prefer Supabase (also free and works great):

1. Go to [supabase.com](https://supabase.com)
2. Create a new project
3. Get connection string from Settings → Database
4. Follow the same steps above (just use Supabase connection string instead)

## Troubleshooting

**"DATABASE_URL not found"**
- Make sure `.env` file exists in project root
- Restart dev server after creating `.env`

**"Can't connect to database"**
- Check connection string is correct
- Make sure password doesn't have special characters that need encoding
- Verify Neon project is active (not paused)

**"Prisma Client not generated"**
- Run `npx prisma generate`
- Restart dev server

**"Tables don't exist"**
- Run `npx prisma db push`
- Check Neon dashboard → Tables to verify

## Next Steps After Database Setup

1. ✅ Database connected
2. ✅ Admin user created
3. ⏳ Create your first blog post
4. ⏳ Test contact form
5. ⏳ Set up file storage for resumes (optional - can use Neon or Vercel Blob)

Need help with any step? Let me know!

